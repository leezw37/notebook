

# 目录

[TOC]

# 编写输入卡

output/input.txt 为输入卡，格式比relap5精简。

## 标题-时间100-201

```idl
= simple pipe flow

******time card*****
*迭代输出100：GMRES内迭代残差输出时间; 牛顿外迭代残差输出时间
*时间离散(0一阶精度1二阶); 空间离散=0：迎风差分；=1：中心差分；=2：二阶迎风；*=3：quick；=4：三阶迎风；=5：fromm；=6：minmod；=7：muscl；=8：koren；=9：smart；=10：superbee；=11：harmonic；=12：ospre；=13：van albada
101   0   0

200   1 *时间设置组数 
201   0.0   10.0   0.01 *开始时间; 结束时间; 步长201; 
```

## 水力部件CCCXXXX(7位)

### tmdpvol

```idl
tmdpvol *不写卡号和部件名称，直接写类型

1000100  1.13097334e-4  0.1  0.0 *面积; 长度; 倾角

*物性参数组数; 控制体参数标记（0p,Ul,Ug,α， 1T,x0， 2p,x0， 3p,T, 其中x0平衡静态含气率)
1000200  2  0
*物性参数组1、2：时间;控制体参数标记(以此为准); 压力; 液相内能(J/kg); 气相内能; 空泡份额
1000201  0.0  0  6.89e6   0.8061e6   2.58198e6  0.0
1000202  100.0  0  6.89e6   0.8061e6   2.58198e6  0.0
```

### tmdpjun

```idl
tmdpjun

*上游控制体（不区分面，100组件的01控制体）; 下游控制体; 面积
1030101  10001  10501  1.13097334e-4

1030200  2  0 *物性组数; 接管参数标记（0液、汽流速，1液、汽流量）
1030201  0.0  0  1.1204  1.1204 *组1：时间; 接管参数标记(以此为准); 液、汽流速
1030202  100.0  0  1.1204  1.1204   
```

### sngljun

```idl
sngljun

1100101  10520  11501  1.13097334e-4 *上游控制体; 下游; 面积
*接管参数标记（0液、汽流速，1液、汽流量）; 液相速度; 汽相速度; 4正向阻力系数; 
		*5反向阻力系数; 过冷喷放系数; 两相喷放系数; 接管临界流、阻力系数模型选项ab
1100201  0  1.1204  1.1204  0.0  0.0  0.0  0.0  0
*接管选项ab:*a：是否启用临界流，=0：不启用；=1：启用
*b：接管阻力计算选项，=0：不计算阻力；=1：只计算突缩、突扩的形阻系数；
*=2：只计算输入卡给定的正反向阻力系数造成的局部阻力系数；=3：1、2都计算
```

### pipe

```idl
pipe
1050000  20 *控制体数

1050100  1 *控制体信息组数
*组1：面积; 长度; 倾角; （水位模型标记？壁面粗糙度？）; 控制体编号
1050101  1.13097334e-4  0.075  90.0  0  20

1050200  2 *控制体物性参数组数
*组1/2：参数标记(0p,Ul,Ug,α， 1T,α， 2p,α， 3p,T); 
		*压力; 液相内能(J/kg); 气相内能; 空泡份额; 控制体编号
1050201  0  6.89e6   0.8061e6   2.58198e6  0.0  10
1050202  0  6.89e6   0.8061e6   2.58198e6  0.0  20

1050300  1 *接管物性参数组数
*组1：接管参数标记（0液/汽流速，1液/汽流量）; 液相速度/流量; 汽相速度/流量; 正向阻力系数; 5反向阻力系数; 
		*6过冷喷放系数; 两相喷放系数; 管临界流、阻力系数模型选项ab; 接管编号
1050301  0  1.1204  1.1204  0.0  0.0  1.0  1.0  0  19
```

## 热构件(1CCCGXNN, 8位)

```idl
hstructure

*轴向控制体数量; 径向网格点数; 几何类型(1矩形体2圆柱3球形);
*左边界坐标(管内径); 再淹没标记1(0禁用1启用); 再淹没标记2
11050000   20   5   2   0.006   0   0

11050100   1 *网格格式标记
11050101   4   0.008 *网格数(网格点数-1);右边界坐标(管外径)

11050200   1 *径向材料成分组数？
11050201   5   4 *材料编号(201MMM00卡中的MMM，此处为20100500); 网格编号

11050300   1 *径向功率分布组数？
11050301   1.0   4 *径向功率因子; 网格编号

11050401   464.0 *初始温度

11050500   1 *左边界条件组数？
*边界条件类型(0绝热后两参数无，1定壁温206表温度-时间，2定热流203表热流-时间，3对流); 边界相邻水力控制体/通用表编号; 0; 周向网格长度; 热构件编号
11050501   3  10501  0  0.075   20
*类型W1=3：如果w2=300~399，换热系数-时间表（204表）；w3指定冷源温度，w3小于999，温度-时间表编号；w3大于10000，冷源是控制体，w3=控制体编号
       *如果w2=400~499，换热系数-温度表（205表），w3指定冷源温度，w3小于999，温度-时间表编号；w3大于10000，冷源是控制体，w3=控制体编号
       *如果w2=其它，w2=控制体编号，w3=0

11050600   1 *右边界条件组数？
11050601   0  0  0  0.075   20 *同上

11050700   1 *热源分布组数？
11050701   999   1.0   20 * 热源类型(999查总表202999XX); 热源乘子; 热构件编号
```



## 总表table(CCCXXXNN, 8位)

- 包含了relap5中的热物性表和总表。
- CCC表示表的类型: 201 材料物性表（1-49导热系数，51-99体积热容），202 功率时间表，203 热流时间表，204 换热系数时间表，205 换热系数温度表，206 温度时间表。
- XXX为查表时所需编号。

```idl
*201XXXNN材料物性表，NN分两部分：01-49导热系数，51-99体积热容
table

20100500 4 *导热系数的组数

20100501 3. 14.88 *温度; 导热系数
20100502 373. 15.05
20100503 423. 15.56 
20100504 473. 16.09

20100550 4 *体积热容的组数

20100551 3. 3.81e6 *温度; 体积热容
20100552 373. 3.83e6                      
20100553 423. 3.91e6                      
20100554 473. 3.99e6

*202XXXNN功率时间表
table

20299900   2 *功率组数
20299901   0.0   3195.0 *时间; 功率
20299902   1000.0   3195.0
```

## 结束

```idl
.end. *核对某行前五个字符
```



# 杂项

1. 输入输出均在output文件夹
2. 103 format(A200)，定义输出格式





# 程序文件表

| 文件名(未标注则为.f90格式) | 简介…………..     | 备注                                                         |
| -------------------------- | -------------- | ------------------------------------------------------------ |
| input.txt                  | 输入卡         | 格式与relap5有不同：100时间误差; 101差分格式; 200时间步信息（201开始、结束时间、步长） |
|                            |                |                                                              |
| input                      | 读取输入卡     |                                                              |
| JFNK                       | JFNK迭代       | 使用JFNK方法控制一个时间步内的迭代，外迭代Newton迭代，内迭代Krylov子空间迭代 |
|                            |                |                                                              |
| NUSOL_FI_JFNK              | 主程序         | 两流体模型全隐(full implicit)数值算法（基于JFNK方法）的系统分析程序; <br />读写文件，牛顿迭代调用 JFNK子程序 |
|                            |                |                                                              |
|                            |                |                                                              |
| rdtstep                    | 读取时间步     | read time step                                               |
| rhtadv                     | 读取热构件     | read heat structure ???                                      |
| rpipe                      | 读取管道       | read pipe                                                    |
| rsnlj                      | 读取单接管     | read single junction                                         |
| rtable                     | 读取总表       | read table                                                   |
| rtdj                       | 读取时间接管   | read time dependent junction                                 |
| rtdv                       | 读取时间控制体 | read time dependent volume                                   |
|                            |                |                                                              |

# 变量表

| 变量名          | 简介             | 备注                                                         |
| --------------- | ---------------- | ------------------------------------------------------------ |
|                 |                  |                                                              |
| hbound(n,1,1,k) | 热构件左边界类型 | 1定壁温，2定热流，3定热流                                    |
| hbound(n,2,1,k) | 热构件右边界类型 |                                                              |
|                 |                  |                                                              |
| hicha           |                  |                                                              |
| hitime          | 差分格式相关     | 0) then<br/>		BDT(1) =  1.0d0<br/>		BDT(2) = -1.0d0<br/>		BDT(3) =  0.0d0<br/>	else if (hitime .eq. 1) then<br/>		BDT(1) =  1.5d0<br/>		BDT(2) = -2.0d0<br/>		BDT(3) =  0.5d0 |
|                 |                  |                                                              |

